# pytorch-dropout-layer

A Tensorify plugin that implements a PyTorch dropout layer for regularization with customizable probability and inplace settings.

## Installation

```bash
npm install
```

## Usage

```typescript
import PytorchDropoutLayerPlugin from "./dist/index.js";

// Create a dropout layer instance
const dropoutLayer = new PytorchDropoutLayerPlugin();

// Generate code with custom settings
const code = dropoutLayer.getTranslationCode({
  variableName: "my_dropout",
  p: 0.3,
  inplace: false,
});

console.log(code);
// Output: my_dropout = dropout(p=0.3) # Generated by @tensorify/pytorch-dropout-layer
```

## Configuration

The dropout layer accepts the following settings:

| Setting        | Type      | Default         | Description                                  |
| -------------- | --------- | --------------- | -------------------------------------------- |
| `variableName` | `string`  | `dropout_layer` | Variable name for the dropout layer instance |
| `p`            | `number`  | `0.5`           | Dropout probability (between 0 and 1)        |
| `inplace`      | `boolean` | `false`         | Whether to perform the operation in-place    |

## Development

```bash
# Build TypeScript
npm run build

# Watch mode for development
npm run dev

# Run tests
npm test
```

## Example Configurations

### Default Dropout Layer

```typescript
{
  variableName: "dropout_layer",
  p: 0.5
}
// Output: dropout_layer = dropout(0.5) # Generated by @tensorify/pytorch-dropout-layer
```

### High Dropout Probability

```typescript
{
  variableName: "high_dropout",
  p: 0.8,
  inplace: false
}
// Output: high_dropout = dropout(p=0.8) # Generated by @tensorify/pytorch-dropout-layer
```

### Inplace Dropout

```typescript
{
  variableName: "inplace_dropout",
  p: 0.2,
  inplace: true
}
// Output: inplace_dropout = dropout(p=0.2, inplace=True) # Generated by @tensorify/pytorch-dropout-layer
```

### Low Dropout for Fine-tuning

```typescript
{
  variableName: "fine_tune_dropout",
  p: 0.1
}
// Output: fine_tune_dropout = dropout(p=0.1) # Generated by @tensorify/pytorch-dropout-layer
```

## Plugin Structure

- `src/index.ts` - Main plugin implementation
- `test.js` - Plugin tests
- `tsconfig.json` - TypeScript configuration

## Generated Code

This plugin generates PyTorch code for dropout layers used in regularization:

```python
import torch
import torch.nn.functional as F
from torch.nn.functional import dropout

# Dropout layer with 50% probability
my_dropout = dropout(0.5) # Generated by @tensorify/pytorch-dropout-layer

# Custom dropout with specific probability
custom_dropout = dropout(p=0.3) # Generated by @tensorify/pytorch-dropout-layer

# Inplace dropout for memory efficiency
inplace_dropout = dropout(p=0.2, inplace=True) # Generated by @tensorify/pytorch-dropout-layer
```

## What is Dropout?

Dropout is a regularization technique that randomly sets a fraction of input units to 0 at each update during training time, which helps prevent overfitting. The probability `p` determines the fraction of neurons to drop.

## SDK Compatibility

This plugin is built with the Tensorify SDK v0.0.10 and extends the `ModelLayerNode` base class for optimal compatibility and functionality.

## Contributing

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## License

MIT Â© 2025 Tensorify Developer

## Created with

This plugin was created using [create-tensorify-plugin](https://www.npmjs.com/package/create-tensorify-plugin).
